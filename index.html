<html>
  <head>
    <title>GetRides</title>
  </head>
  <body style = "font-family: Arial; font-size: 30px; background-color: thistle">
    <div id="loads">Loading...</div>
    <script>
  
      async function getData(){
        
      const originalString = "API_KEY:3bjz27ydq97vjwmrc7f8u12oo";
      const base64Encoded = btoa(originalString);
      const currentYear = new Date().getFullYear()+'-01-01';
  
try {
  const response = await fetch('https://intervals.icu/api/v1/athlete/0/activities?oldest='+currentYear+'&fields=type&fields=distance&fields=start_date_local&fields=total_elevation_gain&fields=moving_time', {
    headers: {
      "Authorization": `Basic ${base64Encoded}`,
      "Accept": "application/json"
    }
  });
  const data = await response.json();
  
  let rideCount = 0;
  let rideDistance = 0;
  let rideElevation = 0;
  let rideMovingTime = 0;

  let virtualRideCount = 0;
  let virtualRideDistance = 0;

  data.forEach((ride) => {
    if (ride.type == "VirtualRide"){
      virtualRideCount++;
      virtualRideDistance += ride.distance/1000;
    } else {
      rideCount++;
      rideDistance += ride.distance/1000;
      rideElevation += ride.total_elevation_gain;
      rideMovingTime += ride.moving_time;
    }
  }
              );
//    console.log(rideCount, rideDistance, virtualRideCount, virtualRideDistance);
    document.getElementById("loads").innerHTML = `<p>Real Rides: ${rideCount}, Distance: ${Math.round(rideDistance)} km, Elevation: ${Math.round(rideElevation)} m, Moving Time: ${rideMovingTime} s</p><p>Virtual Rides: ${virtualRideCount}, Distance: ${Math.round(virtualRideDistance)}km</p>`;

    
} catch(error) {
  console.error('Fetch error:', error);
  document.getElementById("loads").innerHTML = 'Error loading wellness data';
}
        
      } // async function getData()
      getData();
    </script>
  </body>
</html>
